<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Deriving Reference Points and Catch Advice • SPoCK</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Deriving Reference Points and Catch Advice">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SPoCK</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a_model_dimensions.html">Description of Model and Data Dimensions</a></li>
    <li><a class="dropdown-item" href="../articles/b_model_parameters.html">Description of Model Parameters</a></li>
    <li><a class="dropdown-item" href="../articles/c_model_equations.html">Description of Model Equations</a></li>
    <li><a class="dropdown-item" href="../articles/d_model_report.html">Description of Model Report</a></li>
    <li><a class="dropdown-item" href="../articles/e_single_region_sablefish_case_study.html">Setting up a Single Region Model (Alaska Sablefish)</a></li>
    <li><a class="dropdown-item" href="../articles/f_single_region_bsai_pollock_case_study.html">Setting up a Single Region Model (BSAI Pollock)</a></li>
    <li><a class="dropdown-item" href="../articles/g_spatial_sablefish_case_study.html">Setting up a Spatial Model (Alaska Sablefish)</a></li>
    <li><a class="dropdown-item" href="../articles/h_closed_loop_simulations.html">Run Closed Loop Simulations</a></li>
    <li><a class="dropdown-item" href="../articles/i_reference_points.html">Deriving Reference Points and Catch Advice</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Deriving Reference Points and Catch Advice</h1>
            
      

      <div class="d-none name"><code>i_reference_points.Rmd</code></div>
    </div>

    
    
<p>Several options exist for deriving management reference points and
catch advice in <code>SPoCK</code>. In this vignette, we will first
discuss the mathematical details for deriving different management
reference points, and then demonstrate how catch advice might be
developed with estimated reference points.</p>
<div class="section level2">
<h2 id="reference-points">Reference Points<a class="anchor" aria-label="anchor" href="#reference-points"></a>
</h2>
<p>Management reference points in <code>SPoCK</code> are divided into
single-region and spatial reference points.</p>
<p>Single-region reference points include:</p>
<ul>
<li><p>Spawning potential ratio (SPR) reference points, which estimate
the fishing mortality rate that reduces spawning biomass per recruit to
x% of the unfished level.</p></li>
<li><p>Maximum sustainable yield (MSY) reference points, based on a
Beverton-Holt relationship, which estimate the fishing mortality rate
that maximizes long-term yield.</p></li>
</ul>
<p>Spatial reference points also include both SPR and MSY-based metrics,
but are further divided into:</p>
<ul>
<li><p>Independent SPR reference points, which estimate region-specific
fishing mortality rates that reduce spawning biomass per recruit to x%
of the unfished level, while ignoring movement.</p></li>
<li><p>Independent MSY reference points, which estimate region-specific
fishing mortality rates that maximize yield within a given
region.</p></li>
<li><p>Global SPR reference points, which estimate a global fishing
mortality rate that reduces total spawning biomass per recruit to x% of
the unfished level, accounting for movement.</p></li>
<li><p>Global MSY reference points, which estimate a global fishing
mortality rate that maximizes long-term yield across all
regions.</p></li>
</ul>
<div class="section level3">
<h3 id="single-region">Single Region<a class="anchor" aria-label="anchor" href="#single-region"></a>
</h3>
<div class="section level4">
<h4 id="sglregionspr">Spawning Potential Ratio Reference Points<a class="anchor" aria-label="anchor" href="#sglregionspr"></a>
</h4>
<p>To derive SPR reference points, users must specify a target
percentage representing the spawning biomass per recruit under fishing
relative to the unfished level. Following that, several additional
quantities are needed to compute these reference points. This
includes:</p>
<ul>
<li>the relative fishing mortality between fleets
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>r</mi><mi>a</mi><msub><mi>t</mi><mi>f</mi></msub><mo>=</mo><mi>F</mi><mi>m</mi><mi>o</mi><mi>r</mi><msub><mi>t</mi><mrow><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>f</mi></mrow></msub><mi>/</mi><msub><mo>∑</mo><mi>f</mi></msub><mi>F</mi><mi>m</mi><mi>o</mi><mi>r</mi><msub><mi>t</mi><mrow><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Frat_f = Fmort_{y = term,f} / \sum_f Fmort_{y = term,f}</annotation></semantics></math>),</li>
<li>fleet-specific fishery selectivity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>e</mi><msubsup><mi>l</mi><mrow><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mrow><mi>F</mi><mi>s</mi><mi>h</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">Sel_{y = term,a,s = 1,f}^{Fsh}</annotation></semantics></math>),</li>
<li>natural mortality for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">M_{y=1,a,s=1}</annotation></semantics></math>),</li>
<li>weight at age for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">W_{y=1,a,s=1}</annotation></semantics></math>),</li>
<li>maturity at age for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><msub><mi>t</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">Mat_{y=1,a,s=1}</annotation></semantics></math>),</li>
<li>spawn timing
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>s</mi><mi>p</mi><mi>w</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">t_{spwn}</annotation></semantics></math>),</li>
<li>a vector of recruitment values
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><msub><mi>c</mi><mrow><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Rec_{y,s}</annotation></semantics></math>),</li>
<li>the recruitment sex ratio
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\psi_s</annotation></semantics></math>),</li>
<li>recruitment age
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>A</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">RecAge</annotation></semantics></math>),
and</li>
<li>the first year in the recruitment vector
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>Y</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">RecYear</annotation></semantics></math>)
to be used for mean recruitment calculations.</li>
</ul>
<p>For relative fishing mortality between fleets and fleet-specific
fishery selectivity, the terminal year is utilized for these
calculations. By contrast, estimates from the first model year are
utilized for natural mortality, weight at age, and maturity at age.</p>
<p>SPR reference points are then derived with the following process:</p>
<p><span class="math display">$$
N_{a = 1}^{fished} = 1 \\
N_{a = 1}^{unfished} = 1
$$</span></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>N</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>f</mi><mi>i</mi><mi>s</mi><mi>h</mi><mi>e</mi><mi>d</mi></mrow></msubsup><annotation encoding="application/x-tex">N_{a = 1}^{fished}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>N</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>u</mi><mi>n</mi><mi>f</mi><mi>i</mi><mi>s</mi><mi>h</mi><mi>e</mi><mi>d</mi></mrow></msubsup><annotation encoding="application/x-tex">N_{a = 1}^{unfished}</annotation></semantics></math>
are the fished and unfished numbers at age per-recruit, respectively,
for the first age class. Subsequent numbers at age per-recruit are then
computed with an exponential mortality model, where fished numbers at
age per-recruit are decremented with both natural and fishing mortality,
while unfished numbers at age per-recruit are only decremented with
natural mortality:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mi>a</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>N</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mi>f</mi></msub><mo>⋅</mo><msub><mi>F</mi><mi>x</mi></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mn>2</mn><mo>&lt;</mo><mi>a</mi><mo>&lt;</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>N</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mi>f</mi></msub><mo>⋅</mo><msub><mi>F</mi><mi>x</mi></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mi>f</mi></msub><mo>⋅</mo><msub><mi>F</mi><mi>x</mi></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
N_{a}^{\text{fished}} = 
\begin{cases}
N_{a - 1}^{\text{fished}} \cdot \exp\left(-\left(M_{y=1,a-1,s=1} + \sum_f \text{Frat}_f \cdot F_x \cdot \text{Sel}_{y=\text{term},a-1,s=1,f}^{\text{Fsh}}\right)\right) &amp; \text{if } 2 &lt; a &lt; n_{\text{ages}} \\
\\
N_{a - 1}^{\text{fished}} \cdot 
\frac{
\exp\left(-\left(M_{y=1,n_{\text{ages}}-1,s=1} + \sum_f \text{Frat}_f \cdot F_x \cdot \text{Sel}_{y=\text{term},n_{\text{ages}}-1,s=1,f}^{\text{Fsh}}\right)\right)
}{
1 - \exp\left(-\left(M_{y=1,n_{\text{ages}},s=1} + \sum_f \text{Frat}_f \cdot F_x \cdot \text{Sel}_{y=\text{term},n_{\text{ages}},s=1,f}^{\text{Fsh}}\right)\right)
} &amp; \text{if } a = n_{\text{ages}}
\end{cases}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mi>a</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>N</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mn>2</mn><mo>&lt;</mo><mi>a</mi><mo>&lt;</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>N</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
N_{a}^{\text{unfished}} = 
\begin{cases}
N_{a - 1}^{\text{unfished}} \cdot \exp\left(-M_{y=1,a-1,s=1}\right) &amp; \text{if } 2 &lt; a &lt; n_{\text{ages}} \\
\\
N_{a - 1}^{\text{unfished}} \cdot 
\frac{
\exp\left(-M_{y=1,n_{\text{ages}}-1,s=1}\right)
}{
1 - \exp\left(-M_{y=1,n_{\text{ages}},s=1}\right)
} &amp; \text{if } a = n_{\text{ages}}
\end{cases}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>x</mi></msub><annotation encoding="application/x-tex">F_x</annotation></semantics></math>
represents the estimated fishing mortality rate that reduces the
spawning biomass per recruit to x%, relative to the unfished level.
Fished and unfished numbers at age per recruit can then be converted to
spawning biomass per recruit quantities
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">SSB</annotation></semantics></math>)
with the following equations:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><msup><mi>B</mi><mtext mathvariant="normal">fished</mtext></msup><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><msubsup><mi>N</mi><mi>a</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><msub><mi>W</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><msub><mtext mathvariant="normal">Mat</mtext><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>t</mi><mtext mathvariant="normal">spwn</mtext></msub><mo>⋅</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mi>f</mi></msub><mo>⋅</mo><msub><mi>F</mi><mi>x</mi></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
SSB^{\text{fished}} = \sum_a N_{a}^{\text{fished}} \cdot W_{y=1,a,s=1} \cdot \text{Mat}_{y=1,a,s=1} \cdot \exp\left(-t_{\text{spwn}} \cdot M_{y=1,a,s=1} + \sum_f \text{Frat}_f \cdot F_x \cdot \text{Sel}_{y=\text{term},a,s=1,f}^{\text{Fsh}} \right)
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><msup><mi>B</mi><mtext mathvariant="normal">unfished</mtext></msup><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><msubsup><mi>N</mi><mi>a</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><msub><mi>W</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><msub><mtext mathvariant="normal">Mat</mtext><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>t</mi><mtext mathvariant="normal">spwn</mtext></msub><mo>⋅</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
SSB^{\text{unfished}} = \sum_a N_{a}^{\text{unfished}} \cdot W_{y=1,a,s=1} \cdot \text{Mat}_{y=1,a,s=1} \cdot \exp\left(-t_{\text{spwn}} \cdot M_{y=1,a,s=1} \right)
</annotation></semantics></math></p>
<p>SPR is then defined as the fraction of fished and unfished spawning
biomass per recruit:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>P</mi><mi>R</mi><mo>=</mo><mfrac><mrow><mi>S</mi><mi>S</mi><msup><mi>B</mi><mrow><mi>f</mi><mi>i</mi><mi>s</mi><mi>h</mi><mi>e</mi><mi>d</mi></mrow></msup></mrow><mrow><mi>S</mi><mi>S</mi><msup><mi>B</mi><mrow><mi>u</mi><mi>n</mi><mi>f</mi><mi>i</mi><mi>s</mi><mi>h</mi><mi>e</mi><mi>d</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
SPR = \frac{SSB^{fished}}{SSB^{unfished}}
</annotation></semantics></math></p>
<p>and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>x</mi></msub><annotation encoding="application/x-tex">F_x</annotation></semantics></math>
is solved for using a non-linear function minimizer by minimizing the
following criteria:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>x</mi></msub><mo>=</mo><mo>arg</mo><munder><mo>min</mo><mi>F</mi></munder><mrow><mo stretchy="true" form="prefix">{</mo><mn>100</mn><mo>⋅</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">SPR</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>F</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mtext mathvariant="normal">x%</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">
F_x = \arg\min_{F} \left\{ 100 \cdot \left( \text{SPR}(F) - \text{x%} \right)^2 \right\}
</annotation></semantics></math></p>
<p>Biological SPR-based reference points
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mi>x</mi></msub><annotation encoding="application/x-tex">B_x</annotation></semantics></math>)
can then be derived by multiplying the fished spawning biomass per
recruit by mean recruitment over a user-defined period and the
recruitment sex-ratio:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>x</mi></msub><mo>=</mo><mi>S</mi><mi>S</mi><msup><mi>B</mi><mtext mathvariant="normal">fished</mtext></msup><mo>⋅</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>Y</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow><mrow><mi>Y</mi><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>A</mi><mi>g</mi><mi>e</mi></mrow></munderover><mi>R</mi><mi>e</mi><msub><mi>c</mi><mrow><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub></mrow><mrow><mi>Y</mi><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>A</mi><mi>g</mi><mi>e</mi><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>Y</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></mfrac><msub><mi>ψ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">
B_x = SSB^{\text{fished}} \cdot \frac{\sum_{RecYear}^{Y - RecAge} Rec_{y,s}}{Y - RecAge - RecYear} \psi_s
</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="sglregionmsy">Maximum Sustainable Yield Reference Points (Beverton-Holt)<a class="anchor" aria-label="anchor" href="#sglregionmsy"></a>
</h4>
<p>Deriving MSY based reference points using a Beverton-Holt stock
recruitment relationship involves maximizing the equilibrium yield per
recruit and requires several additional inputs. For completeness, we
summarize the required inputs to derive MSY based reference points when
assuming a Beverton-Holt relationship. These inputs include:</p>
<ul>
<li>the relative fishing mortality between fleets
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>r</mi><mi>a</mi><msub><mi>t</mi><mi>f</mi></msub><mo>=</mo><mi>F</mi><mi>m</mi><mi>o</mi><mi>r</mi><msub><mi>t</mi><mrow><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>f</mi></mrow></msub><mi>/</mi><msub><mo>∑</mo><mi>f</mi></msub><mi>F</mi><mi>m</mi><mi>o</mi><mi>r</mi><msub><mi>t</mi><mrow><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Frat_f = Fmort_{y = term,f} / \sum_f Fmort_{y = term,f}</annotation></semantics></math>),</li>
<li>fleet-specific fishery selectivity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>e</mi><msubsup><mi>l</mi><mrow><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mrow><mi>F</mi><mi>s</mi><mi>h</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">Sel_{y = term,a,s = 1,f}^{Fsh}</annotation></semantics></math>),</li>
<li>natural mortality for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">M_{y=1,a,s=1}</annotation></semantics></math>),</li>
<li>weight at age for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">W_{y=1,a,s=1}</annotation></semantics></math>),</li>
<li>maturity at age for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><msub><mi>t</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">Mat_{y=1,a,s=1}</annotation></semantics></math>),</li>
<li>an estimate of virgin recruitment
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>),</li>
<li>an estimate of steepness
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>),</li>
<li>the recruitment sex ratio
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\psi_s</annotation></semantics></math>).</li>
</ul>
<p>Similarly, for relative fishing mortality between fleets and
fleet-specific fishery selectivity, terminal year estimates are utilized
for these calculations. By contrast, estimates from the first model year
are utilized for natural mortality, weight at age, and maturity at
age.</p>
<p>MSY reference points can then be derived using the standard
per-recruit calculations, where the initial number of fished and
unfished individuals can be set at an arbitrary value:</p>
<p><span class="math display">$$
N_{a = 1}^{fished} = 1 \\
N_{a = 1}^{unfished} = 1
$$</span></p>
<p>The following numbers-at-age per recruit are then decremented with an
exponential mortality model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mi>a</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>N</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mi>f</mi></msub><mo>⋅</mo><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mn>2</mn><mo>&lt;</mo><mi>a</mi><mo>&lt;</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>N</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mi>f</mi></msub><mo>⋅</mo><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mi>f</mi></msub><mo>⋅</mo><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
  N_{a}^{\text{fished}} = 
    \begin{cases}
  N_{a - 1}^{\text{fished}} \cdot \exp\left(-\left(M_{y=1,a-1,s=1} + \sum_f \text{Frat}_f \cdot F_{msy} \cdot \text{Sel}_{y=\text{term},a-1,s=1,f}^{\text{Fsh}}\right)\right) &amp; \text{if } 2 &lt; a &lt; n_{\text{ages}} \\
  \\
  N_{a - 1}^{\text{fished}} \cdot 
  \frac{
    \exp\left(-\left(M_{y=1,n_{\text{ages}}-1,s=1} + \sum_f \text{Frat}_f \cdot F_{msy} \cdot \text{Sel}_{y=\text{term},n_{\text{ages}}-1,s=1,f}^{\text{Fsh}}\right)\right)
  }{
    1 - \exp\left(-\left(M_{y=1,n_{\text{ages}},s=1} + \sum_f \text{Frat}_f \cdot F_{msy} \cdot \text{Sel}_{y=\text{term},n_{\text{ages}},s=1,f}^{\text{Fsh}}\right)\right)
  } &amp; \text{if } a = n_{\text{ages}}
  \end{cases}
  </annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mi>a</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>N</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mn>2</mn><mo>&lt;</mo><mi>a</mi><mo>&lt;</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>N</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
  N_{a}^{\text{unfished}} = 
    \begin{cases}
  N_{a - 1}^{\text{unfished}} \cdot \exp\left(-M_{y=1,a-1,s=1}\right) &amp; \text{if } 2 &lt; a &lt; n_{\text{ages}} \\
  \\
  N_{a - 1}^{\text{unfished}} \cdot 
  \frac{
    \exp\left(-M_{y=1,n_{\text{ages}}-1,s=1}\right)
  }{
    1 - \exp\left(-M_{y=1,n_{\text{ages}},s=1}\right)
  } &amp; \text{if } a = n_{\text{ages}}
  \end{cases}
  </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">F_{msy}</annotation></semantics></math>
here represents the fishing mortality that would result in equilibrium
yield being maximized. Yield per recruit quantities can then be computed
using Baranov’s catch equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>a</mi></msub><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mi>f</mi></msub><mo>⋅</mo><msub><mi>F</mi><mtext mathvariant="normal">msy</mtext></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mi>f</mi></msub><mo>⋅</mo><msub><mi>F</mi><mtext mathvariant="normal">msy</mtext></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mfrac><mo>⋅</mo><msubsup><mi>N</mi><mi>a</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mi>f</mi></msub><mo>⋅</mo><msub><mi>F</mi><mtext mathvariant="normal">msy</mtext></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
C_{a} = 
\frac{
  \sum_f \text{Frat}_f \cdot F_{\text{msy}} \cdot \text{Sel}_{y=\text{term},a-1,s=1,f}^{\text{Fsh}}
}{
  \left(M_{y=1,a-1,s=1} + \sum_f \text{Frat}_f \cdot F_{\text{msy}} \cdot \text{Sel}_{y=\text{term},a-1,s=1,f}^{\text{Fsh}}\right)
}
\cdot
N_a^{\text{fished}} \cdot 
\left(
  1 - \exp\left[
    -\left(
      M_{y=1,n_{\text{ages}},s=1} + \sum_f \text{Frat}_f \cdot F_{\text{msy}} \cdot \text{Sel}_{y=\text{term},n_{\text{ages}},s=1,f}^{\text{Fsh}}
    \right)
  \right]
\right)
</annotation></semantics></math></p>
<p>Values for equilibrium recruitment are then calculated using the
Beverton-Holt stock recruitment relationship. Estimates of equilibrium
recruitment are needed to convert per recruit quantities to yield and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">B_{msy}</annotation></semantics></math>.
Here, we first derive the fished and unfished spawning biomass per
recruit:</p>
<p><span class="math display">$$
SSB^{\text{fished}} = \sum_a N_{a}^{\text{fished}} \cdot W_{y=1,a,s=1}
\cdot \text{Mat}_{y=1,a,s=1} \cdot \exp\left(-t_{\text{spwn}} \cdot
M_{y=1,a,s=1} + \sum_f \text{Frat}_f \cdot F_x \cdot
\text{Sel}_{y=\text{term},a,s=1,f}^{\text{Fsh}} \right) \\
$$</span></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><msup><mi>B</mi><mtext mathvariant="normal">unfished</mtext></msup><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><msubsup><mi>N</mi><mi>a</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><msub><mi>W</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><msub><mtext mathvariant="normal">Mat</mtext><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>t</mi><mtext mathvariant="normal">spwn</mtext></msub><mo>⋅</mo><msub><mi>M</mi><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
SSB^{\text{unfished}} = \sum_a N_{a}^{\text{unfished}} \cdot W_{y=1,a,s=1} \cdot \text{Mat}_{y=1,a,s=1} \cdot \exp\left(-t_{\text{spwn}} \cdot M_{y=1,a,s=1} \right)
</annotation></semantics></math></p>
<p>Equilibrium recruitment can then be derived with the following:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>q</mi><mo>=</mo><mfrac><mrow><mn>4</mn><mo>⋅</mo><mi>h</mi><mo>⋅</mo><msub><mi>R</mi><mn>0</mn></msub><mo>⋅</mo><mi>S</mi><mi>S</mi><msup><mi>B</mi><mtext mathvariant="normal">fished</mtext></msup></mrow><mrow><mi>S</mi><mi>S</mi><msup><mi>B</mi><mtext mathvariant="normal">unfished</mtext></msup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>S</mi><mi>S</mi><msup><mi>B</mi><mtext mathvariant="normal">fished</mtext></msup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>5</mn><mo>⋅</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
Req = \frac{4\cdot h \cdot R_0 \cdot SSB^{\text{fished}}}{SSB^{\text{unfished}} \cdot (1 - h) + SSB^{\text{fished}} \cdot (5 \cdot h - 1)}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">Req</annotation></semantics></math>
is the equilibrium recruitment. Yield and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">B_{msy}</annotation></semantics></math>
can then be computed by multiplying the yield per recruit and spawning
biomass per recruit by an estimate of equilibrium recruitment:</p>
<p><span class="math display">$$
Yield = \sum_a C_a \cdot Req \\
B_{msy} = SSB^{\text{fished}} \cdot Req
$$</span></p>
<p>Lastly,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">F_{msy}</annotation></semantics></math>
is solved for using a non-linear function minimizer by minimizing the
following criteria (maximizing yield):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>=</mo><mo>arg</mo><munder><mo>min</mo><mi>F</mi></munder><mi>Y</mi><mi>i</mi><mi>e</mi><mi>l</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">
F_{msy} = \arg\min_{F} Yield
</annotation></semantics></math></p>
</div>
</div>
<div class="section level3">
<h3 id="multi-region">Multi Region<a class="anchor" aria-label="anchor" href="#multi-region"></a>
</h3>
<div class="section level4">
<h4 id="spawning-potential-ratio-reference-points">Spawning Potential Ratio Reference Points<a class="anchor" aria-label="anchor" href="#spawning-potential-ratio-reference-points"></a>
</h4>
<p>In general, multi region SPR reference points can be computed in a
similar manner as single region SPR reference points. The additional
complication to calculating spatial reference points includes the
additional region subscript for all quantities, as well as the
<strong>potential</strong> need to account for movement processes.</p>
<div class="section level5">
<h5 id="independent">Independent<a class="anchor" aria-label="anchor" href="#independent"></a>
</h5>
<p>In the case where users assume no movement occurs among regions, SPR
rates can be calculated independently for each region, which results in
region-specific
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">F_{r,x}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">B_{r,x}</annotation></semantics></math>
estimates. Thus, each region has a unique
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">F_{r,x}</annotation></semantics></math>
estimate that can be applied. All calculations are computed in the same
manner as equations described for computing SPR rates in the <a href="#sglregionspr">single region case</a> except that an additional
subscript is added to all demographic rates. Following that,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">F_{r,x}</annotation></semantics></math>
can then be solved for by minimizing the following criteria for each
region:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><mo>=</mo><mo>arg</mo><munder><mo>min</mo><msub><mi>F</mi><mi>r</mi></msub></munder><mrow><mo stretchy="true" form="prefix">{</mo><mn>100</mn><mo>⋅</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">SPR</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>F</mi><mi>r</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mtext mathvariant="normal">x%</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">
F_{r,x} = \arg\min_{F_r} \left\{ 100 \cdot \left( \text{SPR}(F_r) - \text{x%} \right)^2 \right\}
</annotation></semantics></math></p>
<p>Regional biological SPR-based reference points
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mi>x</mi></msub><annotation encoding="application/x-tex">B_x</annotation></semantics></math>)
can then be derived by multiplying the fished spawning biomass per
recruit by regional mean recruitment over a user-defined period and the
recruitment sex-ratio:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><mo>=</mo><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>Y</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow><mrow><mi>Y</mi><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>A</mi><mi>g</mi><mi>e</mi></mrow></munderover><mi>R</mi><mi>e</mi><msub><mi>c</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub></mrow><mrow><mi>Y</mi><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>A</mi><mi>g</mi><mi>e</mi><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>Y</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></mfrac><msub><mi>ψ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">
B_{r,x} = SSB_r^{\text{fished}} \cdot \frac{\sum_{RecYear}^{Y - RecAge} Rec_{r,y,s}}{Y - RecAge - RecYear} \psi_s
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="global">Global<a class="anchor" aria-label="anchor" href="#global"></a>
</h5>
<p>In contrast to computing reference points when assuming independent
populations, SPR rates can also be computed globally, where movement
occurs among regions. Given the assumption of global SPR rates, this
results in a global
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>x</mi></msub><annotation encoding="application/x-tex">F_x</annotation></semantics></math>
estimate, but regional estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">B_{r,x}</annotation></semantics></math>
because mean recruitment estimates are defined regionally. Thus, the
global SPR solution results in a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>x</mi></msub><annotation encoding="application/x-tex">F_x</annotation></semantics></math>
that reduces the global spawning biomass per recruit to x% of its
unfished value, such that the aggregate spawning biomass reaches
equilibrium at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>r</mi></msub><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sum_r B_{r,x}</annotation></semantics></math>
if applied over the long-term. However, this solution does not result in
each region reaching equilibrium at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">B_{r,x}</annotation></semantics></math>.
Note that the same value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>x</mi></msub><annotation encoding="application/x-tex">F_x</annotation></semantics></math>
is applied to each region in the global SPR case.</p>
<p>Deriving global SPR reference points requires a different set of
inputs. These include:</p>
<ul>
<li>the relative fishing mortality between fleets
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>r</mi><mi>a</mi><msub><mi>t</mi><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>=</mo><mi>F</mi><mi>m</mi><mi>o</mi><mi>r</mi><msub><mi>t</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>f</mi></mrow></msub><mi>/</mi><msub><mo>∑</mo><mi>f</mi></msub><mi>F</mi><mi>m</mi><mi>o</mi><mi>r</mi><msub><mi>t</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Frat_{r,f} = Fmort_{r,y = term,f} / \sum_f Fmort_{r,y = term,f}</annotation></semantics></math>),</li>
<li>fleet-specific fishery selectivity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>e</mi><msubsup><mi>l</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mrow><mi>F</mi><mi>s</mi><mi>h</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">Sel_{r,y = term,a,s = 1,f}^{Fsh}</annotation></semantics></math>),</li>
<li>natural mortality for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">M_{r,y=1,a,s=1}</annotation></semantics></math>),</li>
<li>weight at age for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">W_{r,y=1,a,s=1}</annotation></semantics></math>),</li>
<li>maturity at age for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><msub><mi>t</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">Mat_{r,y=1,a,s=1}</annotation></semantics></math>),</li>
<li>spawn timing
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>s</mi><mi>p</mi><mi>w</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">t_{spwn}</annotation></semantics></math>),</li>
<li>a vector of recruitment values
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><msub><mi>c</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Rec_{r,y,s}</annotation></semantics></math>),</li>
<li>a matrix of movement values (\boldsymbol{M}{_{y = term,a,s =
1})</li>
<li>the recruitment sex ratio
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\psi_s</annotation></semantics></math>),</li>
<li>recruitment age
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>A</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">RecAge</annotation></semantics></math>),</li>
<li>the first year in the recruitment vector
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>Y</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">RecYear</annotation></semantics></math>)
to be used for mean recruitment calculations, and</li>
<li>the recruitment proportions (apportionment) by area
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\zeta_r</annotation></semantics></math>).</li>
</ul>
<p>Global SPR reference points are calculated by first setting the
regional numbers-at-age in the per-recruit model equal to the estimated
recruitment apportionment parameters
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\zeta_r</annotation></semantics></math>),
which sum to 1:</p>
<p><span class="math display">$$
N_{r,a = 1}^{\text{fished}} = \zeta_r \\
N_{r,a = 1}^{\text{unfished}} = \zeta_r
$$</span></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>=</mo><mn>1</mn></mrow><mtext mathvariant="normal">fished</mtext></msubsup><annotation encoding="application/x-tex">N_{r,a=1}^{\text{fished}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>=</mo><mn>1</mn></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><annotation encoding="application/x-tex">N_{r,a=1}^{\text{unfished}}</annotation></semantics></math>
represent the regional numbers-at-age per recruit (for the first age
class) under fished and unfished conditions, respectively.</p>
<p>Subsequently, movement is applied. If recruits are allowed to move,
the movement matrix is applied starting from age 1; otherwise, it is
applied starting from age 2:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>𝐍</mi><mi>a</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐍</mi><mi>a</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><msub><mi>𝐌</mi><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><msub><mi>a</mi><mo>min</mo></msub><mo>,</mo><mi>…</mi><mo>,</mo><mi>A</mi><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>a</mi><mo>min</mo></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">if recruits move</mtext></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{N}_a^{\text{fished}} = (\boldsymbol{N}_a^{\text{fished}})^\top \boldsymbol{M}_{y = \text{term}, a, s = 1} \quad \text{for } a = a_{\min}, \dots, A, \quad a_{\min} = 
\begin{cases} 
1 &amp; \text{if recruits move} \\
2 &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>𝐍</mi><mi>a</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐍</mi><mi>a</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><msub><mi>𝐌</mi><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><msub><mi>a</mi><mo>min</mo></msub><mo>,</mo><mi>…</mi><mo>,</mo><mi>A</mi><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>a</mi><mo>min</mo></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">if recruits move</mtext></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{N}_a^{\text{unfished}} = (\boldsymbol{N}_a^{\text{unfished}})^\top \boldsymbol{M}_{y = \text{term}, a, s = 1} \quad \text{for } a = a_{\min}, \dots, A, \quad a_{\min} = 
\begin{cases} 
1 &amp; \text{if recruits move} \\
2 &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>In these expressions,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
denotes the number of modeled ages
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">n_{ages}</annotation></semantics></math>)
in <code>SPoCK</code> multiplied by 10. For example, if 30 ages are
modeled, then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mn>300</mn></mrow><annotation encoding="application/x-tex">A = 300</annotation></semantics></math>.
This extension enables iterative propagation of the plus group under
movement, given that no closed-form solution exists. For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&gt;</mo><msub><mi>n</mi><mrow><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a &gt; n_{ages}</annotation></semantics></math>
in <code>SPoCK</code>, all demographic and fishery parameters are held
constant at the values for the terminal modeled age
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">n_{ages}</annotation></semantics></math>).
Following movement processes, an exponential mortality model is then
applied:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>=</mo><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>⋅</mo><msub><mi>F</mi><mi>x</mi></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mn>2</mn><mo>&lt;</mo><mi>a</mi><mo>&lt;</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">
N_{r,a}^{\text{fished}} = N_{r,a - 1}^{\text{fished}} \cdot \exp\left(-\left(M_{r,y=1,a-1,s=1} + \sum_f \text{Frat}_{r,f} \cdot F_{x} \cdot \text{Sel}_{r,y=\text{term},a-1,s=1,f}^{\text{Fsh}}\right)\right)
\quad \text{if } 2 &lt; a &lt; A
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><mo>=</mo><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mn>2</mn><mo>&lt;</mo><mi>a</mi><mo>&lt;</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">
N_{r,a}^{\text{unfished}} = N_{r,a - 1}^{\text{unfished}} \cdot \exp\left(-\left(M_{r,y=1,a-1,s=1}\right)\right)
\quad \text{if } 2 &lt; a &lt; A
</annotation></semantics></math></p>
<p>Again, fished and unfished numbers at age per recruit can then be
converted to spawning biomass per recruit quantities:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><msub><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><msub><mtext mathvariant="normal">Mat</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>t</mi><mtext mathvariant="normal">spwn</mtext></msub><mo>⋅</mo><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>⋅</mo><msub><mi>F</mi><mi>x</mi></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
SSB^{\text{fished}}_r = \sum_a N_{r,a}^{\text{fished}} \cdot W_{r,y=1,a,s=1} \cdot \text{Mat}_{r,y=1,a,s=1} \cdot \exp\left(-t_{\text{spwn}} \cdot M_{r,y=1,a,s=1} + \sum_f \text{Frat}_{r,f} \cdot F_x \cdot \text{Sel}_{r,y=\text{term},a,s=1,f}^{\text{Fsh}} \right)
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><msub><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><msub><mtext mathvariant="normal">Mat</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>t</mi><mtext mathvariant="normal">spwn</mtext></msub><mo>⋅</mo><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
SSB^{\text{unfished}}_r = \sum_a N_{r,a}^{\text{unfished}} \cdot W_{r,y=1,a,s=1} \cdot \text{Mat}_{r,y=1,a,s=1} \cdot \exp\left(-t_{\text{spwn}} \cdot M_{r,y=1,a,s=1} \right)
</annotation></semantics></math></p>
<p>and the global spawning potential ratio can then be computed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>P</mi><mi>R</mi><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mi>r</mi></munder><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">fished</mtext></msubsup></mrow><mrow><munder><mo>∑</mo><mi>r</mi></munder><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">fished</mtext></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
SPR = \frac{\sum_r SSB^{\text{fished}}_r}{\sum_r SSB^{\text{fished}}_r}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>x</mi></msub><annotation encoding="application/x-tex">F_x</annotation></semantics></math>
is solved for using a non-linear function minimzer by minimizing the
following criteria for global SPR:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>x</mi></msub><mo>=</mo><mo>arg</mo><munder><mo>min</mo><mi>F</mi></munder><mrow><mo stretchy="true" form="prefix">{</mo><mn>100</mn><mo>⋅</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">SPR</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>F</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mtext mathvariant="normal">x%</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">
F_x = \arg\min_{F} \left\{ 100 \cdot \left( \text{SPR}(F) - \text{x%} \right)^2 \right\}
</annotation></semantics></math></p>
<p>Then, biological SPR-based reference points are assumed to be
regional
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">B_{r,x}</annotation></semantics></math>)
and are derived by multiplying the fished spawning biomass per recruit
by regional mean recruitment over a user-defined period and the
recruitment sex-ratio:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><mo>=</mo><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>Y</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow><mrow><mi>Y</mi><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>A</mi><mi>g</mi><mi>e</mi></mrow></munderover><mi>R</mi><mi>e</mi><msub><mi>c</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub></mrow><mrow><mi>Y</mi><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>A</mi><mi>g</mi><mi>e</mi><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>Y</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></mfrac><msub><mi>ψ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">
B_{r,x} = SSB^{\text{fished}}_r \cdot \frac{\sum_{RecYear}^{Y - RecAge} Rec_{r,y,s}}{Y - RecAge - RecYear} \psi_s
</annotation></semantics></math></p>
<p>Thus, the global SPR calculations result in a global
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mi>x</mi></msub><annotation encoding="application/x-tex">F_x</annotation></semantics></math>
and regional
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">B_{r,x}</annotation></semantics></math>
estimates.</p>
</div>
</div>
<div class="section level4">
<h4 id="maximum-sustainble-yield-reference-points-beverton-holt">Maximum Sustainble Yield Reference Points (Beverton-Holt)<a class="anchor" aria-label="anchor" href="#maximum-sustainble-yield-reference-points-beverton-holt"></a>
</h4>
<p>MSY-based reference points assuming a Beverton-Holt stock recruitment
relationship can be derived either assuming independent populations
without movement or a global population with movement processes
incorporated.</p>
<div class="section level5">
<h5 id="independent-1">Independent<a class="anchor" aria-label="anchor" href="#independent-1"></a>
</h5>
<p>Deriving MSY reference points assuming independent populations is
similar to a single-region case, and results in region-specific
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">F_{r,msy}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">B_{r,msy}</annotation></semantics></math>
estimates, which can be applied to each region when conducting catch
projections to determine management advice.In general, all calcualtions
are computed in the same manner as equations described for computing MSY
in the <a href="#sglregionmsy">single region case</a>, with the
exception that demographic rates and fishery selectivity include a
region subscript. Notably, virgin recruitment is considered regional to
compute equilibrium recruitment in these calculations and is derived in
the following manner:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mrow><mi>r</mi><mo>,</mo><mn>0</mn></mrow></msub><mo>=</mo><msub><mi>R</mi><mn>0</mn></msub><msub><mi>ζ</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">
R_{r,0} = R_0 \zeta_r 
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><msub><mi>q</mi><mi>r</mi></msub><mo>=</mo><mfrac><mrow><mn>4</mn><mo>⋅</mo><msub><mi>h</mi><mi>r</mi></msub><mo>⋅</mo><msub><mi>R</mi><mrow><mi>r</mi><mo>,</mo><mn>0</mn></mrow></msub><mo>⋅</mo><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">fished</mtext></msubsup></mrow><mrow><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>h</mi><mi>r</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>5</mn><mo>⋅</mo><msub><mi>h</mi><mi>r</mi></msub><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
Req_r = \frac{4\cdot h_r \cdot R_{r,0} \cdot SSB_r^{\text{fished}}}{SSB_r^{\text{unfished}} \cdot (1 - h_r) + SSB_r^{\text{fished}} \cdot (5 \cdot h_r - 1)}
</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">F_{r,msy}</annotation></semantics></math>
is then derived by minimizing (maximizing) yield for each region
independently:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>=</mo><mo>arg</mo><munder><mo>min</mo><msub><mi>F</mi><mi>r</mi></msub></munder><mi>Y</mi><mi>i</mi><mi>e</mi><mi>l</mi><msub><mi>d</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">
F_{r,msy} = \arg\min_{F_r} Yield_r
</annotation></semantics></math></p>
<p>and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">B_{r,msy}</annotation></semantics></math>
can then be derived as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>=</mo><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mrow><mi>f</mi><mi>i</mi><mi>s</mi><mi>h</mi><mi>e</mi><mi>d</mi></mrow></msubsup><mi>R</mi><mi>e</mi><msub><mi>q</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">
B_{r,msy} = SSB_r^{fished} Req_r
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="global-1">Global<a class="anchor" aria-label="anchor" href="#global-1"></a>
</h5>
<p>Deriving global MSY in a spatial cointext requires movement among
regions to be accounted for. Similar to the global SPR case, this
results in a global
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">F_{msy}</annotation></semantics></math>
estimate, but regional estiamtes of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">B_{r,msy}</annotation></semantics></math>
because recruitment parameters are defined regionally. This results in a
reference point that achieves
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>r</mi></msub><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sum_r B_{r,msy}</annotation></semantics></math>
for the entire population if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">F_{msy}</annotation></semantics></math>
is applied to each region, but does not ensure that each region is at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">B_{r,msy}</annotation></semantics></math>.</p>
<p>Global MSY reference points requires the following inputs:</p>
<ul>
<li>the relative fishing mortality between fleets
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>r</mi><mi>a</mi><msub><mi>t</mi><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>=</mo><mi>F</mi><mi>m</mi><mi>o</mi><mi>r</mi><msub><mi>t</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>f</mi></mrow></msub><mi>/</mi><msub><mo>∑</mo><mi>f</mi></msub><mi>F</mi><mi>m</mi><mi>o</mi><mi>r</mi><msub><mi>t</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Frat_{r,f} = Fmort_{r,y = term,f} / \sum_f Fmort_{r,y = term,f}</annotation></semantics></math>),</li>
<li>fleet-specific fishery selectivity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>e</mi><msubsup><mi>l</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mrow><mi>F</mi><mi>s</mi><mi>h</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">Sel_{r,y = term,a,s = 1,f}^{Fsh}</annotation></semantics></math>),</li>
<li>natural mortality for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">M_{r,y=1,a,s=1}</annotation></semantics></math>),</li>
<li>weight at age for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">W_{r,y=1,a,s=1}</annotation></semantics></math>),</li>
<li>maturity at age for females
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><msub><mi>t</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">Mat_{r,y=1,a,s=1}</annotation></semantics></math>),</li>
<li>spawn timing
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>s</mi><mi>p</mi><mi>w</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">t_{spwn}</annotation></semantics></math>),</li>
<li>a vector of recruitment values
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><msub><mi>c</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Rec_{r,y,s}</annotation></semantics></math>),</li>
<li>a matrix of movement values (\boldsymbol{M}{_{y = term,a,s =
1})</li>
<li>the recruitment sex ratio
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\psi_s</annotation></semantics></math>),</li>
<li>recruitment age
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>A</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">RecAge</annotation></semantics></math>),</li>
<li>the first year in the recruitment vector
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>Y</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">RecYear</annotation></semantics></math>)
to be used for mean recruitment calculations,</li>
<li>the global steepness value to be used, which is taken as the mean
across all regions if steepness is estimated to be regional
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mfrac><mrow><msub><mo>∑</mo><mi>r</mi></msub><msub><mi>h</mi><mi>r</mi></msub></mrow><msub><mi>n</mi><mrow><mi>r</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">h = \frac{\sum_r h_r}{n_{regions}}</annotation></semantics></math>),
and</li>
<li>the recruitment proportions (apportionment) by area
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\zeta_r</annotation></semantics></math>).</li>
</ul>
<p>Using standard per-recruit calculations, we will first define the
initial number of fished and unfished individuals based on the
recruitment proportions to each area:</p>
<p><span class="math display">$$
N_{r,a = 1}^{\text{fished}} = \zeta_r \\
N_{r,a = 1}^{\text{unfished}} = \zeta_r
$$</span></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>=</mo><mn>1</mn></mrow><mtext mathvariant="normal">fished</mtext></msubsup><annotation encoding="application/x-tex">N_{r,a=1}^{\text{fished}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>=</mo><mn>1</mn></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><annotation encoding="application/x-tex">N_{r,a=1}^{\text{unfished}}</annotation></semantics></math>
represent the regional numbers-at-age per recruit (for the first age
class) under fished and unfished conditions, respectively. We can then
apply movement dynamics. If recruits are allowed to move, the movement
matrix is applied starting from age 1; otherwise, it is applied starting
from age 2:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>𝐍</mi><mi>a</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐍</mi><mi>a</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><msub><mi>𝐌</mi><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><msub><mi>a</mi><mo>min</mo></msub><mo>,</mo><mi>…</mi><mo>,</mo><mi>A</mi><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>a</mi><mo>min</mo></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">if recruits move</mtext></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{N}_a^{\text{fished}} = (\boldsymbol{N}_a^{\text{fished}})^\top \boldsymbol{M}_{y = \text{term}, a, s = 1} \quad \text{for } a = a_{\min}, \dots, A, \quad a_{\min} = 
\begin{cases} 
1 &amp; \text{if recruits move} \\
2 &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>𝐍</mi><mi>a</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐍</mi><mi>a</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><msub><mi>𝐌</mi><mrow><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mi>a</mi><mo>=</mo><msub><mi>a</mi><mo>min</mo></msub><mo>,</mo><mi>…</mi><mo>,</mo><mi>A</mi><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>a</mi><mo>min</mo></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">if recruits move</mtext></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>2</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\boldsymbol{N}_a^{\text{unfished}} = (\boldsymbol{N}_a^{\text{unfished}})^\top \boldsymbol{M}_{y = \text{term}, a, s = 1} \quad \text{for } a = a_{\min}, \dots, A, \quad a_{\min} = 
\begin{cases} 
1 &amp; \text{if recruits move} \\
2 &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>In these expressions,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
denotes the number of modeled ages
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">n_{ages}</annotation></semantics></math>)
in <code>SPoCK</code> multiplied by 10. For example, if 30 ages are
modeled, then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mn>300</mn></mrow><annotation encoding="application/x-tex">A = 300</annotation></semantics></math>.
This extension enables iterative propagation of the plus group under
movement, given that no closed-form solution exists. For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&gt;</mo><msub><mi>n</mi><mrow><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a &gt; n_{ages}</annotation></semantics></math>
in <code>SPoCK</code>, all demographic and fishery parameters are held
constant at the values for the terminal modeled age
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">n_{ages}</annotation></semantics></math>).
After movement processes occur, an exponential mortality model is then
applied:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>=</mo><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>⋅</mo><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mn>2</mn><mo>&lt;</mo><mi>a</mi><mo>&lt;</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">
N_{r,a}^{\text{fished}} = N_{r,a - 1}^{\text{fished}} \cdot \exp\left(-\left(M_{r,y=1,a-1,s=1} + \sum_f \text{Frat}_{r,f} \cdot F_{msy} \cdot \text{Sel}_{r,y=\text{term},a-1,s=1,f}^{\text{Fsh}}\right)\right)
\quad \text{if } 2 &lt; a &lt; A
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><mo>=</mo><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mn>2</mn><mo>&lt;</mo><mi>a</mi><mo>&lt;</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">
N_{r,a}^{\text{unfished}} = N_{r,a - 1}^{\text{unfished}} \cdot \exp\left(-\left(M_{r,y=1,a-1,s=1}\right)\right)
\quad \text{if } 2 &lt; a &lt; A
</annotation></semantics></math></p>
<p>Baranov’s catch equation is then invoked to compute yield per recruit
in each regio:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>⋅</mo><msub><mi>F</mi><mtext mathvariant="normal">msy</mtext></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>⋅</mo><msub><mi>F</mi><mtext mathvariant="normal">msy</mtext></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mfrac><mo>⋅</mo><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>⋅</mo><msub><mi>F</mi><mtext mathvariant="normal">msy</mtext></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><msub><mi>n</mi><mtext mathvariant="normal">ages</mtext></msub><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
C_{r,a} = 
\frac{
  \sum_f \text{Frat}_{r,f} \cdot F_{\text{msy}} \cdot \text{Sel}_{r,y=\text{term},a-1,s=1,f}^{\text{Fsh}}
}{
  \left(M_{r,y=1,a-1,s=1} + \sum_f \text{Frat}_{r,f} \cdot F_{\text{msy}} \cdot \text{Sel}_{r,y=\text{term},a-1,s=1,f}^{\text{Fsh}}\right)
}
\cdot
N_{r,a}^{\text{fished}} \cdot 
\left(
  1 - \exp\left[
    -\left(
      M_{r,y=1,n_{\text{ages}},s=1} + \sum_f \text{Frat}_{r,f} \cdot F_{\text{msy}} \cdot \text{Sel}_{r,y=\text{term},n_{\text{ages}},s=1,f}^{\text{Fsh}}
    \right)
  \right]
\right)
</annotation></semantics></math></p>
<p>Equilibrium recruitment is then computed using the Beverton-Holt
stock recruitment relationship, where we first need to derive the
quantities for fished and unfished spawning biomass per recruit:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><msub><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><msub><mtext mathvariant="normal">Mat</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>t</mi><mtext mathvariant="normal">spwn</mtext></msub><mo>⋅</mo><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>+</mo><munder><mo>∑</mo><mi>f</mi></munder><msub><mtext mathvariant="normal">Frat</mtext><mrow><mi>r</mi><mo>,</mo><mi>f</mi></mrow></msub><mo>⋅</mo><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>⋅</mo><msubsup><mtext mathvariant="normal">Sel</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mtext mathvariant="normal">term</mtext><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>f</mi></mrow><mtext mathvariant="normal">Fsh</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
SSB_r^{\text{fished}} = \sum_a N_{r,a}^{\text{fished}} \cdot W_{r,y=1,a,s=1} \cdot \text{Mat}_{r,y=1,a,s=1} \cdot \exp\left(-t_{\text{spwn}} \cdot M_{r,y=1,a,s=1} + \sum_f \text{Frat}_{r,f} \cdot F_{msy} \cdot \text{Sel}_{r,y=\text{term},a,s=1,f}^{\text{Fsh}} \right)
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><msubsup><mi>N</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><msub><mi>W</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><msub><mtext mathvariant="normal">Mat</mtext><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>t</mi><mtext mathvariant="normal">spwn</mtext></msub><mo>⋅</mo><msub><mi>M</mi><mrow><mi>r</mi><mo>,</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>a</mi><mo>,</mo><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
SSB_r^{\text{unfished}} = \sum_a N_{r,a}^{\text{unfished}} \cdot W_{r,y=1,a,s=1} \cdot \text{Mat}_{r,y=1,a,s=1} \cdot \exp\left(-t_{\text{spwn}} \cdot M_{r,y=1,a,s=1} \right)
</annotation></semantics></math></p>
<p>Calculations for equilibrium recruitment then follow as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><msub><mi>q</mi><mi>r</mi></msub><mo>=</mo><mfrac><mrow><mn>4</mn><mo>⋅</mo><msub><mi>h</mi><mi>r</mi></msub><mo>⋅</mo><msub><mi>R</mi><mn>0</mn></msub><msub><mi>ζ</mi><mi>r</mi></msub><mo>⋅</mo><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">fished</mtext></msubsup></mrow><mrow><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">unfished</mtext></msubsup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mtext mathvariant="normal">fished</mtext></msubsup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>5</mn><mo>⋅</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
Req_r = \frac{4\cdot h_r \cdot R_{0} \zeta_r \cdot SSB_r^{\text{fished}}}{SSB_r^{\text{unfished}} \cdot (1 - h) + SSB_r^{\text{fished}} \cdot (5 \cdot h - 1)}
</annotation></semantics></math></p>
<p>Lastly, yield and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">B_{r,msy}</annotation></semantics></math>
can then be calculated by multiplying per recruit quantities by
equilibrium recruitment:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mi>i</mi><mi>e</mi><mi>l</mi><msub><mi>d</mi><mi>r</mi></msub><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><munder><mo>∑</mo><mi>r</mi></munder><msub><mi>C</mi><mrow><mi>r</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>⋅</mo><mi>R</mi><mi>e</mi><msub><mi>q</mi><mi>r</mi></msub><msub><mi>B</mi><mrow><mi>r</mi><mo>,</mo><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>=</mo><mi>S</mi><mi>S</mi><msubsup><mi>B</mi><mi>r</mi><mrow><mi>f</mi><mi>i</mi><mi>s</mi><mi>h</mi><mi>e</mi><mi>d</mi></mrow></msubsup><mo>⋅</mo><mi>R</mi><mi>e</mi><msub><mi>q</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">
Yield_r = \sum_a \sum_r C_{r,a} \cdot Req_r
B_{r,msy} = SSB_r^{fished} \cdot Req_r
</annotation></semantics></math></p>
<p>and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><annotation encoding="application/x-tex">F_{msy}</annotation></semantics></math>
is solved for by minimizing (or maximizing) the system wide yield:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>m</mi><mi>s</mi><mi>y</mi></mrow></msub><mo>=</mo><mo>arg</mo><munder><mo>min</mo><mi>F</mi></munder><mi>Y</mi><mi>i</mi><mi>e</mi><mi>l</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">
F_{msy} = \arg\min_{F} Yield
</annotation></semantics></math></p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="deriving-catch-advice">Deriving Catch Advice<a class="anchor" aria-label="anchor" href="#deriving-catch-advice"></a>
</h2>
<p>A core part of the assessment process is to convert reference point
estimates into catch advice. In the following sections, we will
mathematically describe how catch advice is derived, and proceed to
provide code examples for demonstration. To conduct projection from the
terminal year, users will need the following quantities:</p>
<ul>
<li>Terminal year estimates of numbers-at-age,</li>
<li>A user defined period of of recruitment values to use,</li>
<li>A user defined period of weight-at-age values to use for
projections,</li>
<li>A user defined period of natural mortality-atage values to use for
projections,</li>
<li>A user defined period of maturity-at-age values to use for
projections,</li>
<li>A user defined period of fishery selectivity values to use for
projections,</li>
<li>A user defined period of movement values to use for
projections,</li>
<li>Terminal year estimates of fishing mortality,</li>
<li>Fishing mortality rate to use to decrement the population,</li>
<li>Optionally, biological reference points to use, if a harvest control
rule is utilized,and</li>
<li>A function describing a harvest control rule.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Cheng.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
