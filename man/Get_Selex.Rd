% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Get_Selex.R
\name{Get_Selex}
\alias{Get_Selex}
\title{Calculate Selectivity}
\usage{
Get_Selex(
  Selex_Model,
  TimeVary_Model,
  ln_Pars,
  ln_seldevs,
  Region,
  Year,
  Bin,
  Sex
)
}
\arguments{
\item{Selex_Model}{Integer specifying the selectivity model:
\describe{
  \item{0}{Logistic selectivity: uses b50 and slope parameters}
  \item{1}{Gamma-shaped (dome) selectivity: uses bin-at-peak and delta parameters}
  \item{2}{Power function selectivity: decreasing selectivity with bin}
  \item{3}{Logistic selectivity using b50 and b95}
  \item{4}{Double-normal (dome-shaped) selectivity with plateau and flexible tails}
}}

\item{TimeVary_Model}{Integer specifying time variation structure:
\describe{
  \item{0}{No time variation (constant or blocked)}
  \item{1}{IID deviations}
  \item{2}{Random walk over time}
  \item{3}{3D AR1-GMRF marginal}
  \item{4}{3D AR1-GMRF conditional}
  \item{5}{2D AR1-GMRF}
}}

\item{ln_Pars}{Vector of log-transformed selectivity parameters. Interpretation depends on `Selex_Model`.}

\item{ln_seldevs}{Array of selectivity deviations (may be log-scale), dimensioned as:
[n_regions, n_years, n_bins, n_sexes, 1]. Used for time-varying or semi-parametric selectivity.}

\item{Region}{Integer index for region}

\item{Year}{Integer index for year}

\item{Bin}{Numeric vector of bins to compute selectivity for}

\item{Sex}{Integer index for sex}
}
\value{
A numeric vector of selectivity values corresponding to the bins specified in the model.
}
\description{
Computes selectivity using one of several parametric or semi-parametric models.
Supports both constant and time-varying selectivity, including random effects and GMRF-based deviations.
}
\details{
Selectivity parameters are transformed internally (typically using `exp()` or logistic transformations)
to ensure they remain in valid ranges. Deviations (`ln_seldevs`) apply multiplicatively to these transformed
parameters when time-varying models are used. For semi-parametric models (TimeVary_Model 3â€“5), deviations are applied directly to the resulting selectivity curve.
}
\keyword{internal}
